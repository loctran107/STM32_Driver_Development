/**
  ******************************************************************************
  * @file    main.c
  * @author  Auto-generated by STM32CubeIDE
  * @version V1.0
  * @brief   Default main function.
  ******************************************************************************
*/

#include "../drivers/Inc/gpio_driver.h"

void delay() {
	for (uint32_t i = 0; i < 1000000; i++);
}
/*
 * Write the program that handles the on board LED using on board
 * button
 */
int main(void)
{
	//Setting up the on board LED configuration

	//Enable the GPIO peripheral clock for on board LED
	GPIO_PeriClkCtrl(GPIOD, ENABLE);


	//Enable the LED
	GPIO_Handle_t GPIO_LED;
	GPIO_LED.pGPIOx = GPIOD;
	GPIO_LED.GPIOx_PinConfig.GPIO_PinNumber = GPIO_PIN_12;
	GPIO_LED.GPIOx_PinConfig.GPIO_PinSpeed = GPIO_HIGH_SPEED;
	GPIO_LED.GPIOx_PinConfig.GPIO_PinPuPdCtrl = GPIO_NO_PU_PD;
	GPIO_LED.GPIOx_PinConfig.GPIO_PinMode = GPIO_OUTPUT_MODE;
	GPIO_LED.GPIOx_PinConfig.GPIO_PinOPType = GPIO_PUSH_PULL;
	GPIO_Init(&GPIO_LED);

	//Enable the Button
	GPIO_Handle_t GPIO_Button;
	GPIO_Button.pGPIOx = GPIOA;
	GPIO_Button.GPIOx_PinConfig.GPIO_PinNumber = GPIO_PIN_0;
	GPIO_Button.GPIOx_PinConfig.GPIO_PinPuPdCtrl = GPIO_NO_PU_PD;
	GPIO_Button.GPIOx_PinConfig.GPIO_PinMode = GPIO_INPUT_MODE;
	GPIO_Init(&GPIO_Button);

	//Toggle the pin
	while (1) {
		if (GPIO_ReadFromInputPin(GPIOA, GPIO_PIN_0)) {
			GPIO_WriteToOutputPin(GPIOD, GPIO_LED.GPIOx_PinConfig.GPIO_PinNumber, 1);
			delay();
		} else {
			GPIO_WriteToOutputPin(GPIOD, GPIO_LED.GPIOx_PinConfig.GPIO_PinNumber, 0);
		}
	}
}
